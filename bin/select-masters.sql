select m.id, m.type, name_first_t.name_first, name_middle_t.name_middle, name_last_t.name_last, name_suffix_t.name_suffix, name_credential_t.name_credential, gender_t.gender, dateOfBirth_t.dateOfBirth, isSoleProprietor_t.isSoleProprietor, phone_t.phone, primarySpecialty_t.primarySpecialty, secondarySpecialty_t.secondarySpecialty
from MProvider m
left join (select counts.mId, counts.name_first from (   select m.mId, cp.name_first, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   where cp.name_first is not null   group by m.mId, cp.name_first ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     where cp.name_first is not null     group by m.mId, cp.name_first   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) name_first_t on m.id = name_first_t.mId
left join (select counts.mId, counts.name_middle from (   select m.mId, cp.name_middle, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   where cp.name_middle is not null   group by m.mId, cp.name_middle ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     where cp.name_middle is not null     group by m.mId, cp.name_middle   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) name_middle_t on m.id = name_middle_t.mId
left join (select counts.mId, counts.name_last from (   select m.mId, cp.name_last, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   where cp.name_last is not null   group by m.mId, cp.name_last ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     where cp.name_last is not null     group by m.mId, cp.name_last   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) name_last_t on m.id = name_last_t.mId
left join (select counts.mId, counts.name_suffix from (   select m.mId, cp.name_suffix, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   where cp.name_suffix is not null   group by m.mId, cp.name_suffix ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     where cp.name_suffix is not null     group by m.mId, cp.name_suffix   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) name_suffix_t on m.id = name_suffix_t.mId
left join (select counts.mId, counts.name_credential from (   select m.mId, cp.name_credential, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   where cp.name_credential is not null   group by m.mId, cp.name_credential ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     where cp.name_credential is not null     group by m.mId, cp.name_credential   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) name_credential_t on m.id = name_credential_t.mId
left join (select counts.mId, counts.gender from (   select m.mId, cp.gender, count(*) count   from CIndividual cp    join Merge m on m.sId = cp.id   where cp.gender is not null   group by m.mId, cp.gender ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CIndividual cp      join Merge m on m.sId = cp.id     where cp.gender is not null     group by m.mId, cp.gender   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) gender_t on m.id = gender_t.mId
left join (select counts.mId, counts.dateOfBirth from (   select m.mId, cp.dateOfBirth, count(*) count   from CIndividual cp    join Merge m on m.sId = cp.id   where cp.dateOfBirth is not null   group by m.mId, cp.dateOfBirth ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CIndividual cp      join Merge m on m.sId = cp.id     where cp.dateOfBirth is not null     group by m.mId, cp.dateOfBirth   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) dateOfBirth_t on m.id = dateOfBirth_t.mId
left join (select counts.mId, counts.isSoleProprietor from (   select m.mId, cp.isSoleProprietor, count(*) count   from CIndividual cp    join Merge m on m.sId = cp.id   where cp.isSoleProprietor is not null   group by m.mId, cp.isSoleProprietor ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CIndividual cp      join Merge m on m.sId = cp.id     where cp.isSoleProprietor is not null     group by m.mId, cp.isSoleProprietor   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) isSoleProprietor_t on m.id = isSoleProprietor_t.mId
left join (select counts.mId, counts.phone from (   select m.mId, t.phone as phone, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   join PhoneNumber t on t.id = cp.phone   where t.phone is not null   group by m.mId, t.phone ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     join PhoneNumber t on t.id = cp.phone     where t.phone is not null     group by m.mId, t.phone   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) phone_t on m.id = phone_t.mId
left join (select counts.mId, counts.primarySpecialty from (   select m.mId, t.code as primarySpecialty, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   join Specialty t on t.id = cp.primarySpecialty   where t.code is not null   group by m.mId, t.code ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     join Specialty t on t.id = cp.primarySpecialty     where t.code is not null     group by m.mId, t.code   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) primarySpecialty_t on m.id = primarySpecialty_t.mId
left join (select counts.mId, counts.secondarySpecialty from (   select m.mId, t.code as secondarySpecialty, count(*) count   from CProvider cp    join Merge m on m.sId = cp.id   join Specialty t on t.id = cp.secondarySpecialty   where t.code is not null   group by m.mId, t.code ) counts where counts.count = (   select max(counts.count)   from   (     select m.mId, count(*) as count     from CProvider cp      join Merge m on m.sId = cp.id     join Specialty t on t.id = cp.secondarySpecialty     where t.code is not null     group by m.mId, t.code   ) counts2   where counts2.mId = counts.mId ) group by counts.mId) secondarySpecialty_t on m.id = secondarySpecialty_t.mId;